<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= team[0].team_name%> | OfficeHub
    </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel='shortcut icon' href='/Images/favicon.ico' type='image/x-icon'>
    <link rel="stylesheet" href="/Css/Home_page.css">
    <style>
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #ccc;
            margin-bottom: 10px;
        }

        .progress-bar-fill {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
        }

        .checkbox {
            margin-right: 10px;
        }

        progress[value] {
            width: 350px;
        }
    </style>
</head>

<body>
    <%- include('nav')%>
        <main>
            <div class="m-6 h-auto rounded-xl p-2">
                <div
                    class="border border-2 border-black rounded-xl h-46 p-4 mb-4 flex items-center justify-between bg-[#afd2f4]">
                    <div class="menu-left ml-4">
                        <div class="text-3xl">
                            <%=team[0].team_name%>
                        </div>
                        <div>
                            <%=team[0].team_des%>
                        </div>
                    </div>
                    <div class="menu-right font-bold flex flex-col justify-center items-center">
                        <div class="text-xl">Members</div>
                        <div>
                            <%= team[0].user1%>
                        </div>
                        <div>
                            <%= team[0].user2%>
                        </div>
                        <div>
                            <% if (team[0].user3!=null) { %>
                                <%= team[0].user3%>
                            <% } %>
                        </div>
                        <div>
                            <% if (team[0].user4!=null) { %>
                                <%= team[0].user4%>
                            <% } %>
                        </div>
                    </div>
                </div>
                <div class="ml-max">
                    <div class="relative h-12 mb-4 -w-screen">
                        <div>
                            <a href="../index/<%=team[0].tcode%>"
                                class="text-xl border border-2 border-black rounded-xl hover:font-bold p-2">Upload</a>
                        </div>
                        <div class="absolute bottom-0 right-0">
                            <a href="/Message"><img class="msg w-12 rounded-3xl" src="/Images/msg.png" alt="msg"></a>
                        </div>
                    </div>

                </div>
                <div class="w-96 m-4 bg-[#e2e8f0] p-6 border-2 border-black">
                    <h1 class="mb-6 text-2xl font-bold text-[#7da4e3] flex flex-col justify-center items-center">
                        Initiate Project</h1>
                    <!-- <form method="post" action="/yourteam/project/<%=team[0].tcode%>" id="form2" class="space-y-3"> -->
                    <form method="post" action="/yourteam/<%=team[0].tcode%>" id="form2" class="space-y-3">
                        <div>
                            <label class='text-[#000000] '>Project Name</label>
                            <input type="text" id="pname" name="pname" class="w-full mt-2 py-3 px-2 bg-white rounded-xl"
                                required>
                        </div>
                        <button type="submit"
                            class="py-3 px-6 rounded-xl border-bold bg-[#FFFFFF] hover:bg-[#7da4e3] text-[#7da4e3] font-bold hover:text-[#FFFFFF]">Initiate</button>
                    </form>
                </div>
                <div class="h-auto grid grid-cols-3 grid-flow-row">
                    <% for (var i=0; i <pro.length; i++ ) { %>
                        <% if (pro[i].pro_progress!=100) {%>
                            <div class="m-4 border border-black rounded-xl p-4 h-44 w-96">
                                <div class="font-bold mb-4 text-xl">
                                    <%=pro[i].pro_name%>
                                </div>
                                <div clas="object-none object-bottom">
                                    <progress max="100" value="<%=pro[i].pro_progress%>" class="w-98"></progress>
                                    <div class="flex flex-row justify-between">
                                        <label><input type="checkbox" class="a<%=pro[i].pro_name%>" name="a" id="a" <% if (pro[i].pu1){%>checked<%}%>>
                                            <%= team[0].user1%>
                                        </label>
                                        <label><input type="checkbox" class="b" name="b" id="b" <% if (pro[i].pu2){%>checked<%}%>>
                                            <%= team[0].user2%>
                                        </label>
                                        <% if (team[0].user3!=null) { %>
                                            <label><input type="checkbox" class="c" name="c" id="c" <% if (pro[i].pu3){%>checked<%}%>>
                                                <%= team[0].user3%>
                                            </label>
                                        <% } %>
                                        <% if (team[0].user4!=null) { %>
                                            <label><input type="checkbox" class="d" name="d" id="d" <% if (pro[i].pu4){%>checked<%}%>>
                                                <%= team[0].user4%>
                                            </label>
                                        <% } %>
                                    </div>
                                    <% if ((team[0].user1==data.username) && (pro[i].pu1==false)) {%>
                                        <button type="submit" onclick="updatea(`<%=pro[i].pro_name%>`,`<%=team[0].user1%>`)"
                                            class="m-2 rounded-xl w-auto p-2 flex flex-col justify-betweenborder border-2 border-black border-bold bg-[#FFFFFF] hover:bg-[#7da4e3] text-[#7da4e3] font-bold hover:text-[#FFFFFF]">Submit</button>
                                    <% } %>
                                    <% if ((team[0].user2==data.username) && (pro[i].pu2==false)) {%>
                                        <button type="submit" onclick="updatea(`<%=pro[i].pro_name%>`,`<%=team[0].user1%>`)"
                                            class="m-2 rounded-xl w-auto p-2 flex flex-col justify-betweenborder border-2 border-black border-bold bg-[#FFFFFF] hover:bg-[#7da4e3] text-[#7da4e3] font-bold hover:text-[#FFFFFF]">Submit</button>
                                    <% } %>
                                    <% if ((team[0].user3==data.username) && (pro[i].pu3==false)) {%>
                                        <button type="submit" onclick="updatea(`<%=pro[i].pro_name%>`,`<%=team[0].user1%>`)"
                                            class="m-2 rounded-xl w-auto p-2 flex flex-col justify-betweenborder border-2 border-black border-bold bg-[#FFFFFF] hover:bg-[#7da4e3] text-[#7da4e3] font-bold hover:text-[#FFFFFF]">Submit</button>
                                    <% } %>
                                    <% if ((team[0].user4==data.username) && (pro[i].pu4==false)) {%>
                                        <button type="submit" onclick="updatea(`<%=pro[i].pro_name%>`,`<%=team[0].user1%>`)"
                                            class="m-2 rounded-xl w-auto p-2 flex flex-col justify-betweenborder border-2 border-black border-bold bg-[#FFFFFF] hover:bg-[#7da4e3] text-[#7da4e3] font-bold hover:text-[#FFFFFF]">Submit</button>
                                    <% } %>
                                </div>
                            </div>
                        <% } %>
                    <% } %>
                </div>
                <div class="text-2xl font-bold">Completed Projects</div>
                <% for (var i=0; i <pro.length; i++ ) { %>
                    <% if (pro[i].pro_progress==100) {%>
                        <div class="m-4 border border-black rounded-xl p-4 h-auto w-96">
                            <div class="font-bold text-xl">
                                <%=pro[i].pro_name%>
                            </div>
                        </div>
                    <% } %>
                <% } %>
            </div>
        </main>
    <%- include('footer')%>
</body>
<script>
    function updatea(val,user) {
        console.log(val);
        const b = '.a';
        const c = b.concat(val)
        console.log("B:", c);
        const a = document.querySelector(c);
        console.log(a.checked);
        if (a.checked) {
            console.log("true");
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/yourteam/update/" + val+"/"+user);
            xhr.send();
        }
        else {
            console.log("false");
        }
        window.location.reload()
    }
</script>
</html>